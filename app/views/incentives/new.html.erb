<h1>Configure Incentives</h1>
<%= simple_form_for(incentive,  url: setup_project_incentives_path(current_user.project), method: :post) do |f| %>
<%= f.input :state, collection: State.configurables(true) %>
<%= f.input :package, collection: @project.packages %>
<div class="row">
    <div class="col-md-6">
        <div class="form-group">
            <label class="control-label">Org. Units Groups</label>
            <select
                id="org_units_groups_selector"
                data-selected="<%=params[:incentive_config][:entity_groups].join(',') if params[:incentive_config] && params[:incentive_config][:entity_groups]%>"
                data-placeholder="Lookup the organisation units groups here..."
                data-selection="org_units_groups_selection"
                data-url="<%= organisation_unit_group_setup_project_autocomplete_index_path(current_user.project, siblings:true) %>"
                class="form-control sol-powered"
                name="incentive_config[entity_groups][]"
                multiple="multiple"></select>
        </div>
    </div>
    <div class="col-md-6" id="org_units_groups_selection"></div>
</div>
<div class="form-group">
    <label class="control-label">Date range</label>
    <div class="input-daterange input-group" id="datepicker">
        <%= f.input_field :start_date, class: "form-control" %>
        <span class="input-group-addon">to</span>
        <%= f.input_field :end_date, class: "form-control"  %>
    </div>
</div>
<%= f.submit 'Apply filters', name:  :apply_filters , class: "btn btn-success pull-right" %>


<div>
    <table class="table table-striped table-condensed">
        <thead>
            <tr>
                <th>Activity</th>
                <th>Value</th>
            </tr>
        </thead>
        <body>

            <%= render partial: "incentive", collection: incentive.activity_incentives, as: :activity_incentive %>
        </body>
    </table>
</div>

  <% if incentive.entities%>
    <% if incentive.valid? %>
      <%= f.submit 'Set values', name: :set_values ,  class: "btn btn-danger pull-right" %>
    <%end%>
    <div>
      <h2>Sample affected entities ( <%= incentive.entities.pager.total %> ) </h2>
      <%= render partial: "entity", collection: incentive.entities, as: :entity %>
    </div>


 <%end%>
<% end %>
